# Coding Standards & Workflow
Last Updated: 2025-12-04T15:31:00.000-07:00

## CRITICAL: ALWAYS FOLLOW Q/* INSTRUCTIONS
- **READ ALL q/* files** before starting any work
- **UPDATE q/* files** when discovering new patterns or system requirements
- **PROVIDE COMPREHENSIVE TESTING INSTRUCTIONS** for every feature
- **FOLLOW session_log.txt maintenance** requirements strictly
- **ASSESS code quality** and prompt for refactoring opportunities

## Q FILE MAINTENANCE
- **Update these /q files regularly** as new patterns emerge
- **Remove outdated information** that no longer applies
- **Prioritize actionable information** over historical details
- **Add new files** if better organization is needed
- **Keep information current** and relevant to ongoing work
- **Update session_log.txt** with recent commands and context after significant work

## TESTING REQUIREMENTS
- **ALWAYS provide step-by-step testing instructions** for new features
- Include prerequisites, expected results, and edge cases
- Test both positive and negative scenarios
- Verify setting persistence and state management
- Document any special access requirements (debug mode, etc.)

## CODE QUALITY MONITORING
- **Check code_quality.txt regularly** for refactoring opportunities
- **Assess code smells** during development work
- **Prompt user for refactoring** when code becomes difficult to maintain
- **Monitor file sizes** and function complexity
- **Identify duplication** and suggest consolidation

## SESSION LOG MAINTENANCE
- Keep last 10-15 commands in session_log.txt
- Update current session summary with major changes
- Include enough context to recover from overflow
- Remove old entries when they become irrelevant
- Focus on actionable information for continuity
- **ALWAYS include comprehensive testing instructions**

## GIT WORKFLOW
- **NEVER automatically push changes** - wait for explicit user instructions
- Only commit and push when user says "push changes", "commit and push", or similar
- Always create backups before making changes
- Use meaningful commit messages
- Test syntax before committing

## DEVELOPMENT WORKFLOW
1. Make incremental changes (one small change at a time)
2. Test after each change
3. Check syntax after each modification
4. Commit working states frequently
5. Use meaningful commit messages
6. **Assess code quality** after significant changes
7. **Provide comprehensive testing instructions**
8. **Update relevant q/* files** with new learnings

## ERROR HANDLING
1. Add minimal debug statements only when debugging
2. Use backups to troubleshoot and revert if needed
3. Remove all debug statements before final commit
4. Check for syntax errors: unmatched braces, duplicate functions

## TESTING PROTOCOL
1. Provide exact testing steps to user
2. Wait for user confirmation before proceeding
3. Fix issues immediately when reported
4. Test in browser console for JavaScript errors
5. **Include comprehensive test scenarios** in session_log.txt

## CODE QUALITY
- Write minimal code that directly addresses requirements
- Avoid verbose implementations
- Follow existing code patterns in the project
- Maintain consistent indentation and formatting
- **Proactively identify refactoring opportunities**

## NEW PATTERN: QUESTION ENCRYPTION SYSTEM
- Questions stored encrypted in questions.enc file (committed to git)
- questions.json is temporary decrypted file for editing (gitignored)
- encrypt-questions.js utility handles encryption/decryption (gitignored)
- Browser decrypts questions.enc at runtime using simpleDecrypt()
- Use ordered arrays: game N requires answer[N-1], shows question[N]
- All questions must have unique numeric answers
- Final question uses mathematical calculation with previous answers

## ENCRYPTION WORKFLOW
**To update questions:**
1. Run `node encrypt-questions.js` to create questions.json
2. Edit questions.json with new content
3. Run `node encrypt-questions.js` again to update questions.enc
4. Delete questions.json (automatically gitignored)
5. Test game loads questions properly
6. Commit and push questions.enc

**Security considerations:**
- Never commit questions.json to git
- Encryption key is in code but provides basic obfuscation
- Users browsing git only see encrypted questions.enc
- Game decrypts seamlessly at runtime
